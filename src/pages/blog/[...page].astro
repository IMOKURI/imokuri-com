---
import BaseLayout from "../../layouts/BaseLayout.astro";
import BlogPost from "../../components/BlogPost.astro";
import Footer from "../../components/Footer.astro";
import NavBar from "../../components/NavBar.astro";
import ToggleTheme from "../../components/ToggleTheme.astro";
import { getCollection } from "astro:content";

export async function getStaticPaths({ paginate }) {
    const posts = (await getCollection("blog")).sort(
        (a, b) => b.data.date.valueOf() - a.data.date.valueOf()
    );
    return paginate(posts, { pageSize: 10 });
}
const { page } = Astro.props;
---

<BaseLayout>
    <NavBar />
    <ToggleTheme />
    <main class="container mx-auto w-2/3">
        <h1 class="my-5 text-4xl font-bold">Blog</h1>

        {page.data.map((post) => <BlogPost post={post} />)}

        <div class="btn-group flex justify-center m-5">
            <a href="/blog">
                <button class="btn btn-outline mx-2">First</button>
            </a>
            {
                page.url.prev && (
                    <a href={page.url.prev}>
                        <button class="btn btn-outline mx-2">Prev</button>
                    </a>
                )
            }
            {
                page.url.next && (
                    <a href={page.url.next}>
                        <button class="btn btn-outline mx-2">Next</button>
                    </a>
                )
            }
            <a href={`/blog/${page.lastPage}`}>
                <button class="btn btn-outline mx-2">Last</button>
            </a>
        </div>
    </main>
    <Footer />
</BaseLayout>
